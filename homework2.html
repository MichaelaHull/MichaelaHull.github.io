<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-quiv="X-UA-Compatible" content="IE-edge">
  <meta name="viewpoint" content="width=device-width, initial-scale=1">

  <title>Homework 2</title>
  
  <link rel="stylesheet" href="http://s3.amazonaws.com/codecademy-content/courses/ltp/css/bootstrap.css">
  <link rel="stylesheet" href="stylesheets/main.css">
  <link href="http://s3.amazonaws.com/codecademy-content/courses/ltp/css/shift.css" rel="stylesheet">
  <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
  <script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
  <script src="http://d3js.org/queue.v1.min.js"></script>
  <style type="text/css">
  .axis path,

  .axis line {
    fill: none;
    stroke: #bbbbbb;
    shape-rendering: crispEdges;
    width: 0;
  }

  .axis text {
    font-family: sans-serif;
    font-size: 8px;
  }

  .d3-tip {
  line-height: 1;
  padding: 12px;
/*  background: rgba(0, 0, 0, 0.8);*/
  color: black;
  border-radius: 2px;
  font-family: sans-serif;
  font-size: 14px;
}
  </style>
</head>
<body align="center">

<!--NAVIGATIONBAR-->
  <div class="nav">
    <div class="container">
      <div class="row">
        <div class="col-md-0">
        <ul class="pull-left">
          <li><a href="http://MichaelaHull.github.io#homework">Homework</a></li>
          <li><a href="http://MichaelaHull.github.io#projects">Projects</a></li>
          <li><a href="http://MichaelaHull.github.io#participation">Participation</a></li>
        </ul>
        </div>
        <div class="col-md-0">
        <ul class="pull-right">
          <li><a href="http://MichaelaHull.github.io#about">About</a></li>
          <li><a href="http://MichaelaHull.github.io#contact">Contact</a></li>
          <li><a href="http://MichaelaHull.github.io">Home</a></li>
        </ul>
        </div>
      </div>
    </div>
  </div>

<!--BANNER-->
  <div class="banner">
    <div class="container">
      <h1>Michaela Hull: Homework 2</h1>
      <ul class="pull-right">
        <li><a href="https://github.com/MichaelaHull/MichaelaHull.github.io/blob/master/homework2.html">Code</a></li>
        <li><a href="https://github.com/MichaelaHull/MichaelaHull.github.io/blob/master/data_files/states.csv">Raw Data</a></li>
      </ul>
    </div>
  </div>

<!--CODE-->
<div class="section">
<div class="container">
<script type="text/javascript">

  var colors = {
    "grey": "#bbbbbb",
    "blue": "#4D4D94",
    "purple": {
      "dark": "#7570b3",
      "med": "#8da0cb",
      "light": "#cbd5e8"
    },
    "green":  {
      "dark": "#1b9e77",
      "med": "#66c2a5",
      "light": "#b3e2cd"
    },
    "orange": {
      "dark": "#d95f02",
      "med": "#fc8d62",
      "light": "#fdcdac"
    },
    "pink": {
      "dark": "#e7298a",
      "med": "#e78ac3",
      "light": "#f4cae4"
    },
    "yellow": "#CCA300"
  };

  var area_color = {
    "Middle Atlantic": "#e7298a",
    "New England": "#e78ac3",
    "East South Central": "#1b9e77",
    "South Atlantic": "#66c2a5",
    "West South Central": "#b3e2cd",
    "East North Central": "#7570b3",
    "West North Central": "#8da0cb",
    "Mountain": "#d95f02",
    "Pacific": "#fc8d62"
  };

  var names = {"pop": "Population",
    "income": "Income",
    "illit": "Illiteracy",
    "life_exp": "Life Expectancy",
    "murder": "Murder",
    "hs_grad": "High School Grad.",
    "frost": "Frost"
  };

  var tip = d3.tip()
    .attr("class", "d3-tip")
    .offset([5, 0])
    .html(function(d) {
        return d.state_abb; //+ ": " names[x_var] + ": " + d[x_var] + ", " + names[y_var] + ": " + d[y_var] ;
    });

  var svg_width = 1200;
  var svg_height = svg_width/1.25;
  var margin = 25;
  var plot_height = svg_height - 2*margin;
  var plot_width = plot_height;

  var svg = d3.select("body").append("svg")
    .attr("height", svg_height)
    .attr("width", svg_width)
    .style("border-color", colors.grey)
    .style("border-width", 1)
    .style("border-style", "solid")
    .call(tip);

  var plot = svg.append("g");
  plot.attr("transform", "translate(" + 2*margin + "," + margin + ")");

  function bubble_plot(r_var, x_var, y_var, data, x_ax, y_ax, plot_space) {
    var xdomain = d3.extent(data, function (d) { return +d[x_var]; });
    var ydomain = d3.extent(data, function (d) { return +d[y_var]; });
    var area_max = d3.max(data, function (d) { return d.area; });
    var r_max = x_ax/12;
    console.log("r_max", r_max);
    var x = d3.scale.linear()
      .domain(xdomain)
      .range([0, x_ax - 2*r_max]);
    var y = d3.scale.linear()
      .domain(ydomain)
      .range([y_ax - 2*r_max, 0]);
    var area_scale = Math.pow(r_max, 2)/area_max;
    var yAxis = d3.svg.axis()
        .scale(y)
        .ticks(4)
        .orient("left");
    var xAxis = d3.svg.axis()
        .scale(x)
        .ticks(3)
        .orient("bottom");
    plot_space.append("g")
        .attr("class", "y axis")
        .attr("transform", "translate(" + r_max + "," + r_max + ")")
        .call(yAxis);
    plot_space.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(" + r_max + "," + (y_ax - r_max) + ")")
        .call(xAxis);
    var bubbles = plot_space.selectAll("circle")
          .data(data, function (d) { return d.state_abb; })
          .enter();
    bubbles.append("circle")
      .attr("cx", function (d) { return r_max + x(+d[x_var]); })
      .attr("cy", function (d) { return r_max + y(+d[y_var]); })
      .attr("r", function (d) { return Math.sqrt(d.area * area_scale)})
      .style("fill", function (d) { return area_color[d.division]; })
      .style("fill-opacity", 0.5)
      .on("mouseover", function (d, i) {
        tip.show(d, i);
        d3.select(this)
        .transition(300)
        .style("fill-opacity", 1);
      })
      .on("mouseout", function (d, i) {
        tip.hide(d, i);
        d3.select(this)
        .transition(300)
        .style("fill-opacity", 0.5);
      });
  };

  var keys = ["pop", "income", "illit", "life_exp", "murder", "hs_grad", "frost"];
  keys.sort();

  d3.csv("/data_files/states.csv", function(error, data) {
    data.forEach(function(d) {
      d.area = +d.area;
      d.division = d.division;
      d.frost = +d.frost;
      d.hs_grad = +d.hs_grad;
      d.illit = +d.illit;
      d.income = +d.income;
      d.life_exp = +d.life_exp;
      d.murder = +d.murder;
      d.pop = +d.pop;
      d.region = d.region;
      d.state = d.state;
      d.state_abb = d.state_abb;
    });
    console.log("Data:", data);

    var pad = 10;

    var k;
    var m;

    var small_plot_h = plot_height/keys.length-pad;

    for (k in keys) {
      for (m in keys) {
        var new_plot = plot.append("g");
        new_plot.attr("transform", "translate(" + (k*(small_plot_h+pad)) + "," + (m*(small_plot_h+pad)) + ")");
        bubble_plot("area", keys[k], keys[m], data, small_plot_h, small_plot_h, new_plot);
        }
    };

    for (k in keys) {
      plot.append("text")
          .attr("class", "x label")
          .attr("text-anchor", "middle")
          .attr("x", k*(small_plot_h + pad) + small_plot_h/2)
          .attr("y", plot_height + pad)
          .text(names[keys[k]]);
    }

    for (m in keys) {
      plot.append("text")
          .attr("class", "y label")
          .attr("text-anchor", "middle")
          .attr("transform", "translate(-25," + (m*(small_plot_h+pad) + small_plot_h/2) + ") rotate(-90)")
          .text(names[keys[m]]);
    }

    // bubble_plot("area", "murder", "life_exp", data, plot_height, plot_width, plot);


  });

</script>
</div>
</div>

</body>
</head>
</html>